<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=320">
<title>JRQ 3DS Bestel</title>
<style>
body { background:#222; color:white; text-align:center; font-family:Arial; }
.container { width:300px; margin:0 auto; }
.item { background:#444; margin:10px 0; padding:10px; }
button { width:100%; height:40px; font-size:16px; background:orange; border:none; }
</style>
</head>
<body>

<div class="container">
<h2>Bestel Menu</h2>

<div class="item">
ğŸ” Hamburger - â‚¬5<br><br>
<button onclick="addItem('Hamburger')">Bestel</button>
</div>

<div class="item">
ğŸŸ Friet - â‚¬3<br><br>
<button onclick="addItem('Friet')">Bestel</button>
</div>

<div class="item">
ğŸ¥¤ Drink - â‚¬2<br><br>
<button onclick="addItem('Drink')">Bestel</button>
</div>

</div>

<script>

var endpoint = "https://api.jsonbin.io/v3/b/6996206fae596e708f3543ad";
var masterKey = "$2a$10$7CEnCoPL4ibEoqYWUdMfWeV1LiwaHjd.YoSMNbbg/6vK5EU0i0UGW";

function addItem(itemName){

    var xhr = new XMLHttpRequest();
    xhr.open("GET", endpoint + "/latest", true);
    xhr.setRequestHeader("X-Master-Key", masterKey);

    xhr.onreadystatechange = function(){
        if(xhr.readyState == 4){

            var data = JSON.parse(xhr.responseText);
            var orders = data.record.orders;

            var newNumber = 1;
            for(var key in orders){
                if(parseInt(key) >= newNumber){
                    newNumber = parseInt(key) + 1;
                }
            }

            orders[newNumber] = {
                number: newNumber,
                item: itemName,
                status: "In Bereiding"
            };

            saveOrders(orders);
        }
    };

    xhr.send();
}

function saveOrders(orders){

    var xhr2 = new XMLHttpRequest();
    xhr2.open("PUT", endpoint, true);
    xhr2.setRequestHeader("Content-Type", "application/json");
    xhr2.setRequestHeader("X-Master-Key", masterKey);

    var newData = {
        orders: orders
    };

    xhr2.send(JSON.stringify(newData));
    alert("Bestelling geplaatst!");
}

</script>

</body>
</html>
